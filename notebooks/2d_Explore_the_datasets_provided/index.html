
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation website for PatientFlow">
      
      
        <meta name="author" content="Zella King">
      
      
      
        <link rel="prev" href="../2c_Evaluate_patient_snapshot_models/">
      
      
        <link rel="next" href="../3a_Prepare_group_snapshots/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>2d. Explore the datasets provided - PatientFlow</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
<style>
  /* Make dataframe tables scroll horizontally when they're too wide */
  .md-typeset .dataframe {
    display: block;
    width: 100%;
    max-width: 100%;
    overflow-x: auto;
    white-space: nowrap;
    margin-bottom: 1rem;
    border-collapse: collapse;
  }

  /* Handle table containers */
  .md-typeset div table {
    display: table;
    width: 100%;
  }

  /* Ensure code outputs don't overflow */
  .md-content__inner pre {
    overflow-x: auto;
    max-width: 100%;
  }

  /* Images should not overflow */
  .md-typeset img {
    max-width: 100%;
  }
</style>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2d-explore-the-datasets-provided" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PatientFlow" class="md-header__button md-logo" aria-label="PatientFlow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PatientFlow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2d. Explore the datasets provided
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zmek/patientflow/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zmek/patientflow
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PatientFlow" class="md-nav__button md-logo" aria-label="PatientFlow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PatientFlow
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zmek/patientflow/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zmek/patientflow
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    patientflow: a Python package for real-time predictions of hospital bed demand from current and incoming patients
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MIT License
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About the notebooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0_Set_up_your_environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0. Set up your environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_Meet_the_users_of_our_predictions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Introducing our users
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2a_Create_patient_snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2a. Create patient-level snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2b_Predict_using_patient_snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2b. Make predictions using patient-level snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2c_Evaluate_patient_snapshot_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2c. Evaluate models trained on patient-level snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    2d. Explore the datasets provided
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    2d. Explore the datasets provided
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learn-more-about-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Learn more about the data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-the-notebook-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Set up the notebook environment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-parameters-and-set-file-paths" class="md-nav__link">
    <span class="md-ellipsis">
      Load parameters and set file paths
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explore-ed-visits-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Explore ED visits dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explore ED visits dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grouping-of-columns-in-ed-visits-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Grouping of columns in ED visits dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrival-and-demographic-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Arrival and demographic variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Arrival and demographic variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elapsed-length-of-stay" class="md-nav__link">
    <span class="md-ellipsis">
      Elapsed Length of Stay
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sex-age-group-and-arrival-method" class="md-nav__link">
    <span class="md-ellipsis">
      Sex, age group and arrival method
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Count variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#location-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Location variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observations-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Observations variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Observations variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#count-variables_1" class="md-nav__link">
    <span class="md-ellipsis">
      Count variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#news-scores-and-manchester-triage-score-values" class="md-nav__link">
    <span class="md-ellipsis">
      News Scores and Manchester Triage score values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vital-signs-values" class="md-nav__link">
    <span class="md-ellipsis">
      Vital signs values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Lab variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lab variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lab-orders" class="md-nav__link">
    <span class="md-ellipsis">
      Lab orders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-results" class="md-nav__link">
    <span class="md-ellipsis">
      Lab results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consults-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Consults variables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explore-inpatient-arrivals-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Explore inpatient arrivals dataset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3a_Prepare_group_snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3a. Prepare group snapshots from patient snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3b_Evaluate_group_snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3b. Evaluate group snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3c_Predict_bed_counts_without_using_patient_snapshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3c. Predict bed counts without using patient snapshots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3d_Predict_bed_counts_for_subgroups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3d. Predict bed count distributions for subgroups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4a_Specify_emergency_demand_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4a. Specify requirements for emergency demand prediction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4b_Predict_emergency_demand/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4b. Predict emergency demand
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4c_Evaluate_emergency_demand_predictions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4c. Evaluate predictions of emergency demand
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4d_Predict_emergency_demand_with_special_categories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4d. Evaluate predictions with special categories
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Src
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Src
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Patientflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Patientflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../src/patientflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PatientFlow: A Python package for converting patient-level predictions into output that is useful for bed managers in hospitals
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learn-more-about-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Learn more about the data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-the-notebook-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Set up the notebook environment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-parameters-and-set-file-paths" class="md-nav__link">
    <span class="md-ellipsis">
      Load parameters and set file paths
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explore-ed-visits-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Explore ED visits dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explore ED visits dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grouping-of-columns-in-ed-visits-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Grouping of columns in ED visits dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrival-and-demographic-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Arrival and demographic variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Arrival and demographic variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elapsed-length-of-stay" class="md-nav__link">
    <span class="md-ellipsis">
      Elapsed Length of Stay
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sex-age-group-and-arrival-method" class="md-nav__link">
    <span class="md-ellipsis">
      Sex, age group and arrival method
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Count variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#location-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Location variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observations-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Observations variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Observations variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#count-variables_1" class="md-nav__link">
    <span class="md-ellipsis">
      Count variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#news-scores-and-manchester-triage-score-values" class="md-nav__link">
    <span class="md-ellipsis">
      News Scores and Manchester Triage score values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vital-signs-values" class="md-nav__link">
    <span class="md-ellipsis">
      Vital signs values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Lab variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lab variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lab-orders" class="md-nav__link">
    <span class="md-ellipsis">
      Lab orders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-results" class="md-nav__link">
    <span class="md-ellipsis">
      Lab results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consults-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Consults variables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explore-inpatient-arrivals-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Explore inpatient arrivals dataset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/zmek/patientflow/edit/main/docs/notebooks/2d_Explore_the_datasets_provided.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="2d-explore-the-datasets-provided">2d. Explore the datasets provided</h1>
<p>Two datasets have been provided with this repository. 
- <code>ed_visits.csv</code> 
- <code>inpatient_arrivals.csv</code></p>
<p>These accompany my fully worked example of the modelling of emergency demand for beds. And they are also useful to illustrate what patient snapshots might be made up of. </p>
<p>This notebook does some data exploration by plotting charts of all relevant variables in each dataset. </p>
<p>The <code>inpatient_arrivals</code> dataset contains arrival times of all patients who visited the UCLH Emergency Department (ED) and the Same Day Emergency Care (SDEC) unit, over the period of the data, and were later admitted. It includes their sex, child status (whether adult or child), and which specialty they were admitted to.</p>
<p>The <code>ed_visits</code> database contains a set of snapshots of patients who visited the ED and SDEC over the period of the data, including both admitted and discharged patients. Each snapshot includes information known at the time of the snapshot, and excludes anything that was recorded later, except the variables that serve a 'labels' for model training. These are: <br />
- <code>is_admitted</code> - whether the visit ended in admission to a ward
- <code>final_sequence</code> - the sequence of consultations the patient had during the visit
- <code>specialty</code> - the specialty of the admission, if the patient was admitted</p>
<p>See the <a href="https://github.com/UCL-CORU/patientflow/tree/main/data-dictionaries">data dictionaries</a> for detailed information about the variables in the data provided.</p>
<h2 id="learn-more-about-the-data">Learn more about the data</h2>
<p>I recorded a webinar to demonstrate how we converted data from the UCLH Electronic Health Record in a form suitable for this modelling. If you click on the image below, the video will open at the point where I provide detail about the datasets </p>
<p><a href="https://www.youtube.com/watch?v=ha_zckz3_rU&t=262s" target="_blank">
    <img src="img/thumbnail_NHSR_webinar.jpg" alt="Link to webinar on how to turn your EHR data into predictions of demand for emergency beds" width="600"/>
</a></p>
<h2 id="set-up-the-notebook-environment">Set up the notebook environment</h2>
<pre><code class="language-python"># Reload functions every time
%load_ext autoreload 
%autoreload 2
</code></pre>
<pre><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</code></pre>
<pre><code class="language-python">from patientflow.load import set_project_root
project_root = set_project_root()
</code></pre>
<pre><code>Inferred project root: /Users/zellaking/Repos/patientflow
</code></pre>
<h2 id="load-parameters-and-set-file-paths">Load parameters and set file paths</h2>
<p>Parameters are set in config.json and (for UCLH implementation in config-uclh.yaml). You can change these for your own purposes. I'll talk more about the role of each parameter as it becomes relevant. Here we are loading the pre-defned training, validation and test set dates.  </p>
<pre><code class="language-python">from patientflow.load import set_file_paths

# set file paths
data_file_path, media_file_path, model_file_path, config_path = set_file_paths(
        project_root, 
        data_folder_name='data-public',  # change this to data-synthetic if you don't have the public dataset
        verbose=False
        ) 

</code></pre>
<h2 id="load-data">Load data</h2>
<p>This notebook has been run using real data which you can download from <a href="https://zenodo.org/records/14866057">Zenodo</a> on request. </p>
<p>Alternatively you can use the synthetic dataset that was generated using a stratified sampling approach based on the distributions reported in the <a href="https://github.com/UCL-CORU/patientflow/tree/main/data-dictionaries">data dictionaries</a>. Two relationships from the original data were preserved: the proportion of admitted versus non-admitted patients and the hourly arrival time patterns. All other variables were sampled independently using summary statistics stratified by admission status. This approach maintains relevant dependencies for admission outcomes while treating other variables as independent of each other.</p>
<p>If you don't have the public data, change the argument in the cell above from <code>data_folder_name='data-public'</code> to <code>data_folder_name='data-synthetic'</code>.</p>
<pre><code class="language-python">import pandas as pd
from patientflow.load import load_data

ed_visits = load_data(data_file_path, 
                    file_name='ed_visits.csv', 
                    index_column = 'snapshot_id',
                    sort_columns = [&quot;visit_number&quot;, &quot;snapshot_date&quot;, &quot;prediction_time&quot;], 
                    eval_columns = [&quot;prediction_time&quot;, &quot;consultation_sequence&quot;, &quot;final_sequence&quot;])

inpatient_arrivals = load_data(data_file_path, 
                    file_name='inpatient_arrivals.csv', 
                    index_column = 'arrival_datetime',)

ed_visits.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>snapshot_date</th>
      <th>prediction_time</th>
      <th>elapsed_los</th>
      <th>sex</th>
      <th>arrival_method</th>
      <th>num_obs</th>
      <th>num_obs_events</th>
      <th>num_obs_types</th>
      <th>num_lab_batteries_ordered</th>
      <th>has_consultation</th>
      <th>...</th>
      <th>visited_waiting</th>
      <th>visited_unknown</th>
      <th>latest_obs_respirations</th>
      <th>latest_obs_temperature</th>
      <th>latest_obs_news_score_result</th>
      <th>latest_obs_objective_pain_score</th>
      <th>visit_number</th>
      <th>is_admitted</th>
      <th>specialty</th>
      <th>final_sequence</th>
    </tr>
    <tr>
      <th>snapshot_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>98242</th>
      <td>2031-01-14</td>
      <td>(22, 0)</td>
      <td>20740.0</td>
      <td>M</td>
      <td>Amb no medic</td>
      <td>74</td>
      <td>6</td>
      <td>23</td>
      <td>8</td>
      <td>True</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>19.0</td>
      <td>96.8</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>000019a46d7c</td>
      <td>True</td>
      <td>surgical</td>
      <td>['surgical']</td>
    </tr>
    <tr>
      <th>100119</th>
      <td>2031-01-19</td>
      <td>(15, 30)</td>
      <td>3780.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>29</td>
      <td>3</td>
      <td>23</td>
      <td>1</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>16.0</td>
      <td>98.4</td>
      <td>1.0</td>
      <td>Mild</td>
      <td>00015db18883</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>189750</th>
      <td>2031-09-29</td>
      <td>(22, 0)</td>
      <td>10466.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>12</td>
      <td>2</td>
      <td>12</td>
      <td>0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>32.0</td>
      <td>97.9</td>
      <td>NaN</td>
      <td>Nil</td>
      <td>0001fbabb70e</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>192732</th>
      <td>2031-10-07</td>
      <td>(22, 0)</td>
      <td>13729.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>14</td>
      <td>1</td>
      <td>14</td>
      <td>7</td>
      <td>True</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>97.7</td>
      <td>NaN</td>
      <td>Mild</td>
      <td>00021c715ac7</td>
      <td>False</td>
      <td>NaN</td>
      <td>['surgical']</td>
    </tr>
    <tr>
      <th>119891</th>
      <td>2031-03-12</td>
      <td>(6, 0)</td>
      <td>2504.0</td>
      <td>M</td>
      <td>Walk-in</td>
      <td>9</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mild</td>
      <td>0002af190380</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 68 columns</p>
</div>

<h2 id="explore-ed-visits-dataset">Explore ED visits dataset</h2>
<p>Note that each snapshot has a date and a prediction time formatted separately, with the prediction time as a tuple of (hour, minute). All functions in <code>patientflow</code> expect prediction times in this format. Each record in the snapshots dataframe is indexed by a unique snapshot_id. </p>
<pre><code class="language-python">ed_visits.head(10)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>snapshot_date</th>
      <th>prediction_time</th>
      <th>elapsed_los</th>
      <th>sex</th>
      <th>arrival_method</th>
      <th>num_obs</th>
      <th>num_obs_events</th>
      <th>num_obs_types</th>
      <th>num_lab_batteries_ordered</th>
      <th>has_consultation</th>
      <th>...</th>
      <th>visited_waiting</th>
      <th>visited_unknown</th>
      <th>latest_obs_respirations</th>
      <th>latest_obs_temperature</th>
      <th>latest_obs_news_score_result</th>
      <th>latest_obs_objective_pain_score</th>
      <th>visit_number</th>
      <th>is_admitted</th>
      <th>specialty</th>
      <th>final_sequence</th>
    </tr>
    <tr>
      <th>snapshot_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>98242</th>
      <td>2031-01-14</td>
      <td>(22, 0)</td>
      <td>20740.0</td>
      <td>M</td>
      <td>Amb no medic</td>
      <td>74</td>
      <td>6</td>
      <td>23</td>
      <td>8</td>
      <td>True</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>19.0</td>
      <td>96.8</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>000019a46d7c</td>
      <td>True</td>
      <td>surgical</td>
      <td>['surgical']</td>
    </tr>
    <tr>
      <th>100119</th>
      <td>2031-01-19</td>
      <td>(15, 30)</td>
      <td>3780.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>29</td>
      <td>3</td>
      <td>23</td>
      <td>1</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>16.0</td>
      <td>98.4</td>
      <td>1.0</td>
      <td>Mild</td>
      <td>00015db18883</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>189750</th>
      <td>2031-09-29</td>
      <td>(22, 0)</td>
      <td>10466.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>12</td>
      <td>2</td>
      <td>12</td>
      <td>0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>32.0</td>
      <td>97.9</td>
      <td>NaN</td>
      <td>Nil</td>
      <td>0001fbabb70e</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>192732</th>
      <td>2031-10-07</td>
      <td>(22, 0)</td>
      <td>13729.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>14</td>
      <td>1</td>
      <td>14</td>
      <td>7</td>
      <td>True</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>97.7</td>
      <td>NaN</td>
      <td>Mild</td>
      <td>00021c715ac7</td>
      <td>False</td>
      <td>NaN</td>
      <td>['surgical']</td>
    </tr>
    <tr>
      <th>119891</th>
      <td>2031-03-12</td>
      <td>(6, 0)</td>
      <td>2504.0</td>
      <td>M</td>
      <td>Walk-in</td>
      <td>9</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mild</td>
      <td>0002af190380</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>157035</th>
      <td>2031-06-27</td>
      <td>(15, 30)</td>
      <td>1548.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>14</td>
      <td>1</td>
      <td>14</td>
      <td>4</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>18.0</td>
      <td>97.7</td>
      <td>NaN</td>
      <td>Moderate</td>
      <td>00033228d206</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>209659</th>
      <td>2031-11-30</td>
      <td>(6, 0)</td>
      <td>15020.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>33</td>
      <td>3</td>
      <td>24</td>
      <td>9</td>
      <td>True</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>17.0</td>
      <td>98.2</td>
      <td>0.0</td>
      <td>Nil</td>
      <td>0003d8c503cf</td>
      <td>False</td>
      <td>NaN</td>
      <td>['obs_gyn']</td>
    </tr>
    <tr>
      <th>105648</th>
      <td>2031-02-03</td>
      <td>(12, 0)</td>
      <td>3502.0</td>
      <td>M</td>
      <td>Walk-in</td>
      <td>9</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mild</td>
      <td>00043419ec6b</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>172620</th>
      <td>2031-08-12</td>
      <td>(22, 0)</td>
      <td>7274.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>14</td>
      <td>2</td>
      <td>14</td>
      <td>0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>97.5</td>
      <td>NaN</td>
      <td>Mild</td>
      <td>0004c73468a6</td>
      <td>False</td>
      <td>NaN</td>
      <td>['obs_gyn']</td>
    </tr>
    <tr>
      <th>96560</th>
      <td>2031-01-09</td>
      <td>(22, 0)</td>
      <td>19768.0</td>
      <td>F</td>
      <td>Walk-in</td>
      <td>30</td>
      <td>3</td>
      <td>21</td>
      <td>0</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>17.0</td>
      <td>98.2</td>
      <td>0.0</td>
      <td>Moderate</td>
      <td>0004eacbae15</td>
      <td>False</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 68 columns</p>
</div>

<h3 id="grouping-of-columns-in-ed-visits-dataset">Grouping of columns in ED visits dataset</h3>
<p>The ED visits dataset contains variables of different types. </p>
<p>For convenience, I use a function called <code>get_dict_cols()</code> to organise the charts below into different sections.</p>
<pre><code class="language-python">from patientflow.load import get_dict_cols
dict_cols = get_dict_cols(ed_visits)

for key, value in dict_cols.items():
    print(f&quot;\nColumns in group called {key}:&quot;)
    print(value)


</code></pre>
<pre><code>Columns in group called not used in training:
['snapshot_id', 'snapshot_date', 'prediction_time', 'visit_number', 'training_validation_test', 'random_number']

Columns in group called arrival and demographic:
['elapsed_los', 'sex', 'age_group', 'age_on_arrival', 'arrival_method']

Columns in group called summary:
['num_obs', 'num_obs_events', 'num_obs_types', 'num_lab_batteries_ordered']

Columns in group called location:
['current_location_type', 'total_locations_visited', 'visited_majors', 'visited_otf', 'visited_paeds', 'visited_rat', 'visited_resus', 'visited_sdec', 'visited_sdec_waiting', 'visited_taf', 'visited_utc', 'visited_waiting', 'visited_unknown']

Columns in group called observations:
['num_obs_blood_pressure', 'num_obs_pulse', 'num_obs_air_or_oxygen', 'num_obs_level_of_consciousness', 'num_obs_news_score_result', 'num_obs_temperature', 'num_obs_manchester_triage_acuity', 'num_obs_objective_pain_score', 'num_obs_subjective_pain_score', 'num_obs_glasgow_coma_scale_best_motor_response', 'num_obs_oxygen_delivery_method', 'num_obs_oxygen_flow_rate', 'num_obs_pupil_reaction_right', 'num_obs_uclh_sskin_areas_observed', 'latest_obs_pulse', 'latest_obs_level_of_consciousness', 'latest_obs_manchester_triage_acuity', 'latest_obs_respirations', 'latest_obs_temperature', 'latest_obs_news_score_result', 'latest_obs_objective_pain_score']

Columns in group called lab orders and results:
['lab_orders_bc', 'lab_orders_crp', 'lab_orders_csnf', 'lab_orders_ddit', 'lab_orders_rflu', 'latest_lab_results_crea', 'latest_lab_results_hctu', 'latest_lab_results_k', 'latest_lab_results_lac', 'latest_lab_results_na', 'latest_lab_results_pco2', 'latest_lab_results_ph', 'latest_lab_results_wcc', 'latest_lab_results_htrt', 'latest_lab_results_alb', 'lab_orders_bon', 'lab_orders_ncov', 'lab_orders_xcov']

Columns in group called consults:
['has_consultation', 'consultation_sequence', 'final_sequence', 'specialty']

Columns in group called outcome:
['is_admitted']
</code></pre>
<p>Also for the plots, I convert the boolean columns to text values.</p>
<pre><code class="language-python"># Function to convert boolean columns to text values &quot;true&quot; or &quot;false&quot; - used for plotting format
def bool_to_text(df):
    bool_cols = df.select_dtypes(include='bool').columns.drop('is_admitted')
    for col in bool_cols:
        df[col] = df[col].apply(lambda x: 'true' if x else 'false')
    return df

# Apply the function
ed_visits = bool_to_text(ed_visits)

# temporarily add a is_admitted column to arrivals 
inpatient_arrivals['is_admitted'] = True
inpatient_arrivals = bool_to_text(inpatient_arrivals)
</code></pre>
<p>As some variables are ordinal, I create a dictionary to record the ordering of the values. </p>
<pre><code class="language-python">ordinal_mappings = {
    # age group
    &quot;age_group&quot;: [
        &quot;0-17&quot;,
        &quot;18-24&quot;,
        &quot;25-34&quot;,
        &quot;35-44&quot;,
        &quot;45-54&quot;,
        &quot;55-64&quot;,
        &quot;65-74&quot;,
        &quot;75-115&quot;,
    ],
    # triage score
    &quot;latest_obs_manchester_triage_acuity&quot;: [&quot;Blue&quot;, &quot;Green&quot;, &quot;Yellow&quot;, &quot;Orange&quot;, &quot;Red&quot;],
    # pain score
    &quot;latest_obs_objective_pain_score&quot;: [
        r&quot;Nil&quot;,
        r&quot;Mild&quot;,
        r&quot;Moderate&quot;,
        r&quot;Severe\E\Very Severe&quot;,
    ],
    # level of consciousness
    &quot;latest_obs_level_of_consciousness&quot;: [
        &quot;A&quot;, #alert
        &quot;C&quot;, #confused
        &quot;V&quot;, #voice - responds to voice stimulus
        &quot;P&quot;, #pain - responds to pain stimulus
        &quot;U&quot; #unconscious - no response to pain or voice stimulus
    ]
}
</code></pre>
<h3 id="arrival-and-demographic-variables">Arrival and demographic variables</h3>
<p>Here I import a function called <code>plot_data_distribution</code> to provide a convenient way of requesting each plot without multiple lines of code for each.</p>
<pre><code class="language-python">from patientflow.viz.data_distribution import plot_data_distribution

</code></pre>
<h4 id="elapsed-length-of-stay">Elapsed Length of Stay</h4>
<p>Both admitted and not admitted visits appear to have a long tail of visits lasting more than 24 hours. Any snapshots where the ED visit has lasted more than 72 hours are excluded.</p>
<pre><code class="language-python">ed_visits['elapsed_los_hrs'] = ed_visits['elapsed_los']/3600
plot_data_distribution(df=ed_visits, col_name='elapsed_los_hrs', grouping_var='is_admitted', grouping_var_name='whether patient admitted', plot_type='both',
                        title = 'Distribution of elapsed length of stay by whether patient admitted', truncate_outliers=False)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_20_0.png" /></p>
<p>Below, I plot the snapshots where the elapsed visit duration is greater than 24 hours. We can see that the long tail of longer visits is more numerous for discharged than for admitted patients. This could be because patients leave the ED without being recorded as discharged on the system. </p>
<pre><code class="language-python">if ed_visits[ed_visits.elapsed_los_hrs &gt;= 24].shape[0] &gt; 0:
    plot_data_distribution(ed_visits[ed_visits.elapsed_los_hrs &gt;= 24], 'elapsed_los_hrs', 'is_admitted', 'whether patient admitted', plot_type='both',
                        title = 'Distribution of elapsed length of stay by whether patient admitted (where elapsed length of stay &gt;= 24 hours)', truncate_outliers=False)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_22_0.png" /></p>
<h4 id="sex-age-group-and-arrival-method">Sex, age group and arrival method</h4>
<p>The charts below show distributions between admitted and not admitted patients for sex, age group and arrival method. More older people are admitted. Most walk-ins are discharged.</p>
<pre><code class="language-python">plot_data_distribution(ed_visits, 'sex', 'is_admitted', 'whether patient admitted', plot_type='hist')
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_24_0.png" /></p>
<pre><code class="language-python">if 'age_group' in ed_visits.columns:
    plot_data_distribution(ed_visits, 'age_group', 'is_admitted', 'whether patient admitted', plot_type='hist', ordinal_order=ordinal_mappings['age_group'], rotate_x_labels = True)
else:
    plot_data_distribution(ed_visits, 'age_on_arrival', 'is_admitted', 'whether patient admitted', plot_type='hist')

</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_25_0.png" /></p>
<pre><code class="language-python">plot_data_distribution(ed_visits, 'arrival_method', 'is_admitted', 'whether patient admitted', plot_type='hist', rotate_x_labels = True)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_26_0.png" /></p>
<h3 id="count-variables">Count variables</h3>
<p>The counts variables record the following, up to the moment of the snapshot
* the number of observations recorded
* the number of events at which observations were recorded (if heart rate and respiratory rate have the same timestamp in the original data, this is one event)
* the number of different types of observations (heart rate and respiratory would be two types)
* the number of lab test batteries ordered</p>
<pre><code class="language-python">for col_name in dict_cols['summary']:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', plot_type='hist', is_discrete = False, truncate_outliers=True)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_28_0.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_28_1.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_28_2.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_28_3.png" /></p>
<p>The plots above have been set to exlude outliers, for better readability. However, there are some extreme values of num_obs and num_obs_events. In such cases, you might consider removing the outliers, depending on what model is to be applied to the data</p>
<pre><code class="language-python">print(ed_visits.num_obs.max())
print(ed_visits.num_obs_events.max())
</code></pre>
<pre><code>989
266
</code></pre>
<h3 id="location-variables">Location variables</h3>
<p>The variable <code>current_location_type</code> records the location of the patient at the time of the snapshot. Refer to the <a href="https://github.com/UCL-CORU/patientflow/tree/main/data-dictionaries/ed_visits_data_dictionary.csv">data dictionary</a> for more information about what each location type means. Patients who visit the UTC (Urgent Treatment Centre) are more likely to be discharged than admitted. The UTC provides care for patients with minor injuries and illnesses.</p>
<pre><code class="language-python">plot_data_distribution(ed_visits, 'current_location_type', 'is_admitted', 'whether patient admitted', plot_type='hist', rotate_x_labels = True)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_32_0.png" /></p>
<pre><code class="language-python">for col_name in dict_cols['location'][1:]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', plot_type='hist')
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_0.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_1.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_2.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_3.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_4.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_5.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_6.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_7.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_8.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_9.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_10.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_33_11.png" /></p>
<h3 id="observations-variables">Observations variables</h3>
<p>The variables in the observations group record vital signs, triage scores, and also the number of times certain observations have been recorded, up to the moment of the snapshot.</p>
<pre><code class="language-python">dict_cols['observations']
</code></pre>
<pre><code>['num_obs_blood_pressure',
 'num_obs_pulse',
 'num_obs_air_or_oxygen',
 'num_obs_level_of_consciousness',
 'num_obs_news_score_result',
 'num_obs_temperature',
 'num_obs_manchester_triage_acuity',
 'num_obs_objective_pain_score',
 'num_obs_subjective_pain_score',
 'num_obs_glasgow_coma_scale_best_motor_response',
 'num_obs_oxygen_delivery_method',
 'num_obs_oxygen_flow_rate',
 'num_obs_pupil_reaction_right',
 'num_obs_uclh_sskin_areas_observed',
 'latest_obs_pulse',
 'latest_obs_level_of_consciousness',
 'latest_obs_manchester_triage_acuity',
 'latest_obs_respirations',
 'latest_obs_temperature',
 'latest_obs_news_score_result',
 'latest_obs_objective_pain_score']
</code></pre>
<p>I first plot the variables that count the number of times something was recorded. </p>
<h4 id="count-variables_1">Count variables</h4>
<pre><code class="language-python">for col_name in [item for item in dict_cols['observations'] if str(item).startswith('num')]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', 
                            plot_type='hist', 
                            is_discrete = True, 
                            truncate_outliers=True)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_0.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_1.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_2.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_3.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_4.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_5.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_6.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_7.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_8.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_9.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_10.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_11.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_12.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_38_13.png" /></p>
<h4 id="news-scores-and-manchester-triage-score-values">News Scores and Manchester Triage score values</h4>
<p>News Scores are commonly used to track the acuity of a patient, and Manchester Triage scores are used at the door of the ED to prioritise patients</p>
<pre><code class="language-python">for col_name in [item for item in dict_cols['observations'] if ('manchester' in str(item) ) and str(item).startswith('latest')]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', plot_type='hist', rotate_x_labels = True, ordinal_order=ordinal_mappings['latest_obs_manchester_triage_acuity'])
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_40_0.png" /></p>
<pre><code class="language-python">plot_data_distribution(ed_visits, 'latest_obs_objective_pain_score', 'is_admitted', 'whether patient admitted', 
                        plot_type='hist', 
                        rotate_x_labels = True, 
                        ordinal_order=ordinal_mappings['latest_obs_objective_pain_score'])

</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_41_0.png" /></p>
<pre><code class="language-python">
for col_name in [item for item in dict_cols['observations'] if 'news' in str(item) and str(item).startswith('latest')]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', plot_type='hist', is_discrete = True)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_42_0.png" /></p>
<p>The ACVPU score is commonly used to track states of consciousness</p>
<pre><code class="language-python">for col_name in [item for item in dict_cols['observations'] if 'consciousness' in str(item) and str(item).startswith('latest')]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', 
                            plot_type='hist', 
                            ordinal_order=ordinal_mappings['latest_obs_level_of_consciousness'])
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_44_0.png" /></p>
<p>Temporarily excluding the most common value of A from the ACVPU score, we can see the spread of other values</p>
<pre><code class="language-python">for col_name in [item for item in dict_cols['observations'] if 'consciousness' in str(item) and str(item).startswith('latest')]:
    plot_data_distribution(ed_visits[~(ed_visits.latest_obs_level_of_consciousness == 'A')].copy(), col_name, 'is_admitted', 'whether patient admitted', 
                            plot_type='hist', 
                            ordinal_order=ordinal_mappings['latest_obs_level_of_consciousness'])
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_46_0.png" /></p>
<h4 id="vital-signs-values">Vital signs values</h4>
<p>I now plot the distributions of the vital signs values.</p>
<pre><code class="language-python">for col_name in [item for item in dict_cols['observations'] if str(item).startswith('latest') and ('pulse' in str(item) or 'resp' in str(item) or 'temp' in str(item))]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', 
                            plot_type='hist', 
                            is_discrete = False, 
                            truncate_outliers=True)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_48_0.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_48_1.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_48_2.png" /></p>
<h3 id="lab-variables">Lab variables</h3>
<p>The lab variables include boolean values for whether a lab battery was ordered, and the results of certain lab test. The data include only a small a subset of the lab battery orders and test results that might be requested for a patient in the ED. </p>
<pre><code class="language-python">dict_cols['lab orders and results']
</code></pre>
<pre><code>['lab_orders_bc',
 'lab_orders_crp',
 'lab_orders_csnf',
 'lab_orders_ddit',
 'lab_orders_rflu',
 'latest_lab_results_crea',
 'latest_lab_results_hctu',
 'latest_lab_results_k',
 'latest_lab_results_lac',
 'latest_lab_results_na',
 'latest_lab_results_pco2',
 'latest_lab_results_ph',
 'latest_lab_results_wcc',
 'latest_lab_results_htrt',
 'latest_lab_results_alb',
 'lab_orders_bon',
 'lab_orders_ncov',
 'lab_orders_xcov']
</code></pre>
<h4 id="lab-orders">Lab orders</h4>
<p>It is notable in the charts below, which show whether a lab battery was ordered, that battery CRP (for markers of inflammation) is very commonly ordered for admitted patients; among the patients later admitted the majority have a CRP battery ordered whereas among the non-admitted patients only a minority have it. This difference between admitted and non-admitted (where the majority of admitted have something while the majority of discharged patients do not) only applies to this lab battery order. It will show up later as a strong predictor of admission.</p>
<pre><code class="language-python">for col_name in [item for item in dict_cols['lab orders and results'] if str(item).startswith('lab') ]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', plot_type='hist')
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_0.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_1.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_2.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_3.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_4.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_5.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_6.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_52_7.png" /></p>
<h4 id="lab-results">Lab results</h4>
<p>The plots below show the latest lab values. </p>
<pre><code class="language-python">for col_name in [item for item in dict_cols['lab orders and results'] if str(item).startswith('latest') ]:
    plot_data_distribution(ed_visits, col_name, 'is_admitted', 'whether patient admitted', plot_type='hist', outlier_threshold=3, truncate_outliers=True)
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_0.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_1.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_2.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_3.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_4.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_5.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_6.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_7.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_8.png" /></p>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_54_9.png" /></p>
<h3 id="consults-variables">Consults variables</h3>
<p>The <code>has_consultation</code> variable records whether a referral request was made to another service or specialty up to the point of the snapshot. The sequence of referrals up to that point is recorded in <code>consultation_sequence</code> and the final sequence, at the end of the ED visit in <code>final_sequence</code>. <code>specialty</code> records the specialty that the patient was admitted under, if admitted. </p>
<p>The first plot shows that the number of admitted patients with consult requests at the time of the snapshots is about the same as those without. The group without consult requests will have their later in the visit, after the snapshot was recorded.</p>
<pre><code class="language-python">plot_data_distribution(ed_visits, 'has_consultation', 'is_admitted', 'whether patient admitted', plot_type='hist')
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_56_0.png" /></p>
<p>A very small number of non-admitted patients have a specialty of admission recorded. These are most likely patients referred from ED to SDEC, which we don't include in the admitted patients.</p>
<pre><code class="language-python">plot_data_distribution(ed_visits, 'specialty', 'is_admitted', 'whether patient admitted', plot_type='hist')
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_58_0.png" /></p>
<h2 id="explore-inpatient-arrivals-dataset">Explore inpatient arrivals dataset</h2>
<p>The inpatient_arrivals dataset records all of the arrival dates and and times of patients who were later admitted to a ward. Other information is also recorded, such as sex and child status, as will as specialty of admission. This dataset will be used to predict the number of patients yet-to-arrive at the time of prediction. </p>
<pre><code class="language-python">inpatient_arrivals.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>specialty</th>
      <th>sex</th>
      <th>is_child</th>
      <th>is_admitted</th>
    </tr>
    <tr>
      <th>arrival_datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2031-02-26 11:28:00+00:00</th>
      <td>medical</td>
      <td>M</td>
      <td>false</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2031-01-14 16:51:00+00:00</th>
      <td>surgical</td>
      <td>F</td>
      <td>false</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2031-02-06 20:51:00+00:00</th>
      <td>surgical</td>
      <td>M</td>
      <td>false</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2031-01-10 13:43:00+00:00</th>
      <td>haem/onc</td>
      <td>M</td>
      <td>false</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2031-01-02 13:55:00+00:00</th>
      <td>haem/onc</td>
      <td>F</td>
      <td>false</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># temporarily add is_admitted column to arrivals dataset, to be able to use the plot_data_distribution function
inpatient_arrivals['is_admitted'] = True
plot_data_distribution(inpatient_arrivals.reset_index().copy(), 'specialty', 'is_admitted', 'whether patient admitted', plot_type='hist')
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_61_0.png" /></p>
<pre><code class="language-python">plot_data_distribution(inpatient_arrivals, 'is_child', 'is_admitted', 'whether patient admitted', plot_type='hist')
</code></pre>
<p><img alt="png" src="../2d_Explore_the_datasets_provided_files/2d_Explore_the_datasets_provided_62_0.png" /></p>
<h2 id="summary">Summary</h2>
<p>This notebook has shown how to load files that have been provided, and shows some plots of the variables included. This is an illustrative dataset, showing the type of variables that were used for the analysis at UCLH. Other sites will have different data. </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2024 Zella King
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/zmek" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>